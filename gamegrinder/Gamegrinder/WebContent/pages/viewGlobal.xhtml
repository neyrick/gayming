<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:grind="http://java.sun.com/jsf/composite/components/grind">
      
		<h:head>
		<title>Test page</title>


		</h:head>
	<f:event type="preRenderView" listener="#{calendarDisplay.loadGames}"/>

<h:body bgcolor="#ffffff">



<h:form id="topForm">
<h:outputStylesheet library="css" name="gamegrinder.css"/>
<table style="border:1px solid #CAD6E0"  align="center" cellpadding="0" cellspacing="0" border="0" width="1200">
<tbody>
	<tr>
		<td width="100%" bgcolor="#E4EBEB">
				<rich:panel style="text-align:right" rendered="#{visitor.known}">			
						Salut <h:outputText value="#{visitor.name}" /> ! <h:commandButton action="#{visitor.clear}" value="Changer d'utilisateur"/>
				</rich:panel>
		</td>
	</tr>
	<tr>
		<td height="1" width="100%" bgcolor="#CAD6E0"></td>
	</tr>	

	<tr>
		<td width="100%"  colspan="2" id="bodyCell">
		  <h:panelGrid columns="3" width="100%" rowClasses="calendarPanel" columnClasses="settingsPanel,calendarPanel calendarGlobalColumn">
		  
		  	<h:panelGroup>
		  		<h:inputHidden id="selectedSetting" value="#{planningUpdater.currentSetting}" />
		  		<rich:dataTable var="setting" value="#{settingsDisplay.openSettings}" styleClass="settingsPanel" columnClasses="settingsRow">
					<f:facet name="header"><span class="settingsPanel">Chroniques Ouvertes</span></f:facet>
		  			<rich:column width="50px"  >
		  				<a4j:commandLink styleClass="settingsCellLink" id="settingsCellLink" render="@form" execute="@this">
		  					<f:setPropertyActionListener target="#{planningUpdater.currentSetting}" value="#{setting}"/>
			  				<h:panelGrid columns="2" border="0" cellpadding="0" cellspacing="0" width="100%" columnClasses="settingsCell settingsIconCell,settingsCell settingsNameCell" rowClasses="middle">
			  					<h:panelGroup layout="block" style="#{settingsDisplay.getStyle(setting)};height:15px;"><h:outputText value="#{setting.letter}"/></h:panelGroup>
			  					<h:panelGroup id="settingsNameCell" ><h:outputText value="#{setting.name}"/></h:panelGroup>
			  				</h:panelGrid>
		  				</a4j:commandLink>
		  			</rich:column>
		  		</rich:dataTable>
			  		
		  		<rich:dataTable var="setting" value="#{settingsDisplay.closedSettings}" styleClass="settingsPanel" columnClasses="settingsCell settingsIconCell,settingsCell">
					<f:facet name="header">Chroniques Fermées</f:facet>
		  			<rich:column width="30px" style="#{settingsDisplay.getStyle(setting)}"><h:outputText value="#{setting.letter}"/></rich:column>
		  			<rich:column><h:outputText value="#{setting.name}"/></rich:column>
		  		</rich:dataTable>

		  	</h:panelGroup>
		
		  	<rich:panel styleClass="calendarGlobalColumn" bodyClass="nopad" >
		  		 
			  JSF:
			  <h:messages />
			  <br/>
			  Rich: <rich:messages globalOnly="true"/> 
			<h:panelGrid columns="2">
			  <rich:dataGrid value="#{calendarDisplay.monthsList}" var="month" columns="#{calendarDisplay.monthsList.size()}" elements="#{calendarDisplay.monthsList.size()}" width="100%"
			  styleClass="calendarPanel">
			  	<rich:panel bodyClass="nopad" headerClass="calendarMonthHeader">
			  		<f:facet name="header">
						<h:outputFormat value="#{month}" >
							<f:convertDateTime pattern="MMMM"/>
						</h:outputFormat>
			  		</f:facet>
			  		<rich:dataTable var="day" value="#{calendarDisplay.months.get(month)}" width="260"
			  		rowClasses="#{calendarDisplay.getMonthStyleClasses(month)}" styleClass="calendarMonthPanel">
			  			<rich:column style="padding: 0px;" styleClass="calendarMonthColumn">
			  				<f:facet name="header">
						 	  	<h:panelGrid columns="5" border="0" cellpadding="0" cellspacing="0" width="100%" columnClasses="calendarIconCell,calendarIconCell,calendarIconCell,calendarContentCell,calendarContentCell">
						 	    	<h:outputText styleClass="calendarIconCell" value="&nbsp;"/>
						 	    	<h:outputText styleClass="calendarIconCell" value="&nbsp;"/>
						 	    	<h:outputText styleClass="calendarIconCell" value="&nbsp;"/>
						 	    	<h:outputText styleClass="calendarIconCell" value="Après-midi"/>
						 	    	<h:outputText styleClass="calendarContentCell" value="Soir"/>
						 	  	</h:panelGrid>
			  				</f:facet>
					 	  	<h:panelGrid id="dayGrid" columns="5" border="0" cellpadding="0" cellspacing="0" columnClasses="calendarIconCell,calendarIconCell,calendarIconCell,calendarContentCell,calendarContentCell" >
					 	    	<h:panelGroup styleClass="calendarIconCell">#{day.dayLetter}</h:panelGroup>
					 	    	<h:panelGroup styleClass="calendarIconCell">#{day.dayNumber}</h:panelGroup>
					 	    	<h:panelGroup styleClass="calendarIconCell">N</h:panelGroup>
						 	    <h:panelGroup styleClass="calendarContentCell">
							 	    <a4j:commandLink action="#{planningUpdater.addAvailability()}" styleClass="quietLink" render="dayGrid" execute="@this">+
								 	  	<f:setPropertyActionListener target="#{planningUpdater.currentTimeFrame}" value="#{day.afternoonTimeFrame}"/>
								 	 </a4j:commandLink>
						 	   		<a4j:repeat var="setting" value="#{day.afternoonSettings}">
					  					<h:panelGroup layout="block" style="#{settingsDisplay.getStyle(setting)};height:15px;"><h:outputText value="#{setting.letter}"/></h:panelGroup>
						 	    	</a4j:repeat>
						 	 	</h:panelGroup>
						 	    <h:panelGroup styleClass="calendarContentCell">
							 	    <a4j:commandLink action="#{planningUpdater.addAvailability()}" styleClass="quietLink" render="dayGrid" execute="@this">+
								 	  	<f:setPropertyActionListener target="#{planningUpdater.currentTimeFrame}" value="#{day.eveningTimeFrame}"/>
								 	 </a4j:commandLink>
						 	   		<a4j:repeat var="setting" value="#{day.eveningSettings}">
					  					<h:panelGroup layout="block" style="#{settingsDisplay.getStyle(setting)};height:15px;"><h:outputText value="#{setting.letter}"/></h:panelGroup>
						 	    	</a4j:repeat>
						 	 	</h:panelGroup>
						 	  	</h:panelGrid>
					 	    	<rich:tooltip>
		 	    					Date: <h:outputText value="#{day.date}" >
		 	    						<f:convertDateTime pattern="E dd MMMM yyyy"/>
		 	    					</h:outputText>
	 	    					<br/>
					 	    	</rich:tooltip>
			  			</rich:column>
			  		</rich:dataTable>
			  	</rich:panel>
			  </rich:dataGrid>
			  <grind:daydetailspanel day="#{calendarDisplay.currentDay}" rendered="#{calendarDisplay.editDayMode}"/>   			  
			</h:panelGrid>
			</rich:panel>
			
			<rich:panel style="width:100%" bodyClass="nopad">
				Bloc d'édition
			</rich:panel>

		  </h:panelGrid>

		</td>
	</tr>	
	
</tbody>
</table>
<f:verbatim>
<script>
<!-- 

function activateSettingCell(component, setting) {
//	window.alert('Component: ' + component);
//	window.alert('Setting: ' + setting);
	resetSettingsCells();
	component.style.backgroundColor = 'cyan';
	component.style.fontWeight = 'bold';	
	#{rich:element('selectedSetting')}.value = setting;
}

function resetSettingsCells() {
  	var panels = document.getElementsByClassName('settingsRow');
  	for(var i=0; i<panels.length;i++) {
  		panels[i].style.backgroundColor = '';
  		panels[i].style.fontWeight = '';
	}
}

 -->
 </script>
</f:verbatim>
</h:form>
	    <rich:panel id="namePopupContainer" style="height:1;border:0">
	    	<ui:include src="/includes/visitorpopup.xhtml" />
	    </rich:panel>
</h:body>
		
</html>