<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"> 

	<f:event type="preRenderView" listener="#{calendarDisplay.loadGames}"/>
	<ui:composition template="/templates/common.xhtml">
			<ui:define name="pageTitle">Test title</ui:define>
			<ui:define name="pageHeader">
				<table width="100%" cellspacing="10" cellpadding="0" border="1">
					<tr>
						<td bgcolor="#FFFFFF">Par Date</td>
						<td onclick="document.location.href='viewSetting.jsf';return true;">Par Chronique</td>
					</tr>
				</table>
			</ui:define>
			<ui:define name="body">
			  <h:form id="topForm">
			  JSF:
			  <h:messages />
			  <br/>
			  Rich: <rich:messages globalOnly="true"/>
			<h:panelGrid columns="2">
			  <rich:dataGrid value="#{calendarDisplay.monthsList}" var="month" columns="#{calendarDisplay.monthsList.size()}" elements="#{calendarDisplay.monthsList.size()}" width="100%"
			  styleClass="calendarMonthPanel">
			  	<rich:panel bodyClass="nopad" >
			  		<f:facet name="header">
						<h:outputFormat value="#{month}" >
							<f:convertDateTime pattern="MMMM"/>
						</h:outputFormat>
			  		</f:facet>
			  		<rich:dataTable var="day" value="#{calendarDisplay.months.get(month)}" width="150"
			  		rowClasses="#{calendarDisplay.getMonthStyleClasses(month)}">
			  			<rich:column style="padding: 0px;">
					 	  <a4j:commandLink styleClass="quietLink" render="@form">
					 	  	<f:setPropertyActionListener target="#{calendarDisplay.currentDay}" value="#{day}"/>
					 	  	<h:panelGrid columns="3"  border="0" cellpadding="0" cellspacing="0" width="100%">
					 	    	<rich:panel styleClass="calendarDayCell" style="width: 30px;background-color:inherit;">#{day.dayLetter}
					 	    	</rich:panel>
					 	    	<rich:panel styleClass="calendarDayCell" style="width: 30px;background-color:inherit;">#{day.dayNumber}</rich:panel>
					 	    	<rich:panel styleClass="calendarDayCell" style="width: 100px;background-color:inherit;">
					 	    		<h:outputText value="#{day.games}" />
					 	    	</rich:panel>
					 	  	</h:panelGrid>
					 	    	<rich:tooltip>
		 	    					Date: <h:outputText value="#{day.date}" >
		 	    						<f:convertDateTime pattern="E dd MMMM yyyy"/>
		 	    					</h:outputText>
	 	    					<br/>
					 	    	</rich:tooltip>
					 	  </a4j:commandLink>
			  			</rich:column>
			  		</rich:dataTable>
			  	</rich:panel>
			  </rich:dataGrid>
			  <rich:panel rendered="#{calendarDisplay.editDayMode}">
			  	<f:facet name="header">
			  		<h:outputText value="#{calendarDisplay.currentDay.date}">
			  			<f:convertDateTime pattern="EEEE dd MMMM yyyy"/>
			  		</h:outputText>
			  	</f:facet>
			  	<rich:panel>
			  		<f:facet name="header">Apr√®s-midi</f:facet>
			  		<rich:dataGrid columns="1" var="game" value="#{calendarDisplay.currentDay.afternoonGames}">
			  			<rich:panel>
			  				<f:facet name="header"><h:outputText value="#{game.setting}"/></f:facet>
			  				<p>MJ: <h:outputText value="#{game.gmname}"/></p>
			  				<h:dataTable var="player" value="#{game.players}">
			  					<h:column><h:outputText value="#{player.playerName}" /></h:column>
			  				</h:dataTable>
			  			</rich:panel>
			  		</rich:dataGrid>
			  	</rich:panel>
			  	<rich:panel>
			  		<f:facet name="header">Soir</f:facet>
	  				<p>MJ: <h:outputText value="#{game.gmname}"/></p>
	  				<h:dataTable var="player" value="#{game.players}">
	  					<h:column><h:outputText value="#{player.playerName}" /></h:column>
	  				</h:dataTable>
			  	</rich:panel>
			  </rich:panel>
			</h:panelGrid>
			  </h:form>
			</ui:define>
	</ui:composition>
</html>