<!DOCTYPE html>
<html lang="en" ng-app="gamegrinderApp">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tests Gamegrinder</title>
<link href="css/bootstrap.css" rel="stylesheet" media="screen">
<link rel="stylesheet" href="css/gg.css">
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="js/jquery.js"></script>
<!-- link rel="stylesheet" href="css/bootstrap.css"-->
<script src="lib/angular/angular.js"></script>
<script src="lib/angular/angular-cookies.js"></script>
<script src="js/app.js"></script>
<script src="js/controllers.js"></script>
<script src="js/services.js"></script>
<script src="js/filters.js"></script>
<script src="js/gg.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.js"></script>

<!-- Bootstrap -->
</head>
<body ng-controller="GameGrinderCtrl">
	<script type="text/javascript">
		var popParams = {
			trigger : 'manual',
			container: '#tfpop-container',
			selector : '.tfSetting',
			content : function() {
				var popoverId = '#tfSettingTooltip-' + getTfSettingCode($(this));
				return $(popoverId).html();
			}						
		};
		var ttlock = null;
		
		function getTfSettingCode(item) {
			return item.data('dayid') + '-' + item.data('timeframe') + '-' + item.data('settingcode');
		}

		$(function() {
			$('.tfSetting').hover(function (e) {
				 if (ttlock == null) $(this).popover('show');
			},function (e) {
				 if (ttlock == null) $(this).popover('hide');
			});
			$('.tfSetting').popover(popParams);
			$('tfSettingTooltipBox .tfSettingForm').collapse( { toggle : false } );

			$('body').on('click', function (e) {
			    $('.tfSetting').each(function () {
				var setcode = getTfSettingCode($(this));
				if (!$(this).is(e.target) && $(this).has(e.target).length === 0 && $('.popover').has(e.target).length === 0) {
					if (this.id == ttlock) ttlock = null;
					$(this).popover('hide');
				}
				else {
					if (this.id != ttlock) {
						ttlock = this.id;
						$(this).popover('show');
						$('.tfSettingForm').collapse('show');
					}
					else {
						ttlock = null;
						$('.tfSettingForm').collapse('hide');
						$(this).popover('hide');
					}
				}
			    });
			});
			$('.plusButton').tooltip({
				placement : 'auto',
				title : 'Maîtriser une partie'
			});
			$('.chatButton').tooltip({
				placement : 'auto',
				title : 'Discussions'
			});
			if (typeof angular.element('body').scope().currentUser == 'undefined') {
				$('#loginModal').modal('show');
			}
			$('#loginForm').submit(function(event) {
				$('#loginModal').modal('hide');
			});
		});

		function addAvailablePlayer() {
		}

		function addAvailableGM() {
		}

		function addMessage() {
		}
	</script>

	<div id="loginModal" class="modal fade">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title">C'est qui ?</h4>
				</div>
				<div class="modal-body">
					<form class="form-inline" id="loginForm" role="form"
						name="loginForm" ng-submit="login()">
						<div class="form-group">
							<label for="inputName" class="control-label">Tape ton
								pseudo:</label> <input type="text" class="form-control" id="inputName"
								name="userinput" placeholder="Ton pseudo sur le forum"
								ng-model="currentUser" required />
						</div>
						<div class="form-group">
							<button id="nameButton" class="btn btn-default"
								ng-disabled="loginForm.$invalid" type="submit">Valider</button>
						</div>
					</form>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>

	<div id="mjModal" class="modal fade">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title">Organisation des parties</h4>
				</div>
				<div class="modal-body row">
					<div class="col-md-6">
						<div class="panel panel-default gmColumn">
							<div class="panel-body">
								<div class="btn-group width100p">
									<button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">Je propose de maîtriser... <span class="caret"></span></button>
									<ul class="dropdown-menu" role="menu">
										<li ng-repeat="setting in settingsList"><a tabindex="-1"
											href="#">{{setting.name}}</a></li>
									</ul>
								</div>
							</div>
						</div>
					</div>
					<div class="col-md-6">
						<div class="panel panel-default gmColumn">
							<div class="panel-body">							
								<div class="btn-group width100p">
									<button type="button" class="btn btn-primary dropdown-toggle width100p" data-toggle="dropdown">Je valide une partie de... <span class="caret"></span></button>
									<ul class="dropdown-menu width100p" role="menu">
										<li ng-repeat="settingtf in currentTimeframe.settings"><a tabindex="-1" href="#" ng-click="selectTimeframeSetting(settingtf)">{{settingsList[settingtf.code].name}}</a></li>
									</ul>
								</div>
								<div class="btn-group-vertical width100p" ng-show="currentSettingTf">
									<span class="btn btn-default">{{settingsList[currentSettingTf.code].name}}</span>
									<span class="btn btn-primary">Avec quels joueurs ?</span>
									<button type="button" class="btn {{player|recruitPlayersStyle:currentRecruits}}" ng-repeat="player in currentSettingTf.availableplayers" ng-click="toggleRecruit(player)">{{ player.name }}</button>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer button-group">
					<button type="button" class="btn btn-danger" data-dismiss="modal">Annuler</button>
					<button type="button" class="btn btn-primary" data-dismiss="modal">Enregistrer</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>

	<div style="display: none">

		<div ng-repeat="week in weeks">
			<div ng-repeat="day in week.days">
				<div ng-repeat="timeframe in day.timeframes">
					<div ng-repeat="settingtf in timeframe.settings">
							<div id="tfSettingTooltip-{{day.id}}-{{timeframe.code}}-{{settingtf.code}}" class="panel-group tfSettingTooltipBox">
								<div class="panel-collapse collapse tfSettingTooltipItem tfSettingForm">
									<div class="panel-body list-group">
										<div class="list-group-item">
											Collapsible 1
										</div>
										<div class="list-group-item">
											Collapsible 2
										</div>
									</div>
								</div>
								<div class="panel panel-default tfSettingTooltipItem"
									ng-repeat="game in settingtf.games">
									<div class="panel-body">
										<span class="confirmedgame">Partie confirmée:</span>
										<ul>
											<li>{{ game.gm }} (MJ)</li>
											<li ng-repeat="player in game.players">{{ player.name }}</li>
										</ul>
									</div>
								</div>
								<div class="panel panel-default tfSettingTooltipItem">
									<div class="panel-body">
									MJ Disponible(s):
										<ul>
											<li ng-repeat="player in settingtf.availablegms">{{
												player.name }}</li>
										</ul>
									</div>
								</div>
								<div class="panel panel-default tfSettingTooltipItem">
									<div class="panel-body">
									Joueur(s) Disponible(s):
										<ul>
											<li ng-repeat="player in settingtf.availableplayers">{{
												player.name }}</li>
										</ul>
									</div>
								</div>
							</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div id="chatModal" class="modal fade" tabIndex="-1" role="dialog"
		aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"
						aria-hidden="true">&times;</button>
					<h4 class="modal-title">Discussions concernant le {{
						currentDay }}</h4>
				</div>
				<div class="modal-body list-group">
					<div class="list-group-item">Message 1 ...</div>
					<div class="list-group-item">Message 2 ...</div>
					<textarea class="form-control list-group-item" rows="3"
						placeholder="Tape ton message ici puis clique sur &quot;Enregistrer&quot;"></textarea>
				</div>
				<div class="modal-footer button-group">
					<button type="button" class="btn btn-danger" data-dismiss="modal">Fermer</button>
					<button type="button" class="btn btn-primary" data-dismiss="modal">Enregistrer</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>
	</div>

	<div id="toolbar" class="pageColumn">
		<div id="greetingsDiv" class="panel panel-default"
			ng-show="currentUser">
			<div class="panel-heading">Salut {{ currentUser }} !</div>
			<div class="panel-body">
				<button type="button" ng-click="logout()" class="btn btn-default">Changer
					d'utilisateur</button>
			</div>
		</div>

		<div id="LegendContainer" class="panel panel-default">
			<div class="panel-heading">Chroniques Ouvertes</div>
			<table class="table">
				<tr ng-repeat="setting in settingsList">
					<td class="legendBadge settingCell"><span class="badge">{{
							setting.code }}</span></td>
					<td class="settingCell">{{ setting.name }}</td>
				</tr>
			</table>
			<div class="panel-heading">Chroniques Fermées</div>
		</div>
	</div>


	<div id="tfpop-container"></div>			

	<div class="pageColumn">
		<div class="panel panel-default panel-body weekPanel"
			ng-repeat="week in weeks">

			<div class="panel panel-default day{{day.dow}} dayPanel"
				ng-repeat="day in week.days">
				<div class="panel-body day{{day.dow}} dayBodyPanel">
					<div class="datePanel"></div>
					<div class="timeFramesPanel">
						<div class="panel-default timeFramePanel">
							<div class="timeFrameBodyPanel panel-body datePanel">

								{{ dowcodes[day.dow] }} <a
									id="chatButton-{{day.id}}-{{timeframe.code}}" href="#chatModal"
									class="tfExtra" data-toggle="modal" data-day="{{day.id}}"
									ng-click="selectTimeframe(day.id, timeframe.code)"> <span
									class="glyphicon glyphicon-comment chatButton"></span>
								</a> <br />{{ day.dom }} / {{ day.month }}
							</div>
						</div>
						<div class="panel panel-default timeFramePanel"
							ng-repeat="timeframe in day.timeframes">
							<div class="timeFrameBodyPanel panel-body">
								<img class="timeFrameItem"
									src="{{timeframesDesc[timeframe.code].pic}}"
									data-test="{{timeframe.code}}" /> <a href="#"
									id="tfSettinglink-{{day.id}}-{{timeframe.code}}-{{settingtf.code}}" 
									class="tfSetting" data-toggle="popover" data-delay="0"
									data-placement="auto" data-html="true" data-animation="false"
									data-title="{{settingsList[settingtf.code].name}}"
									data-settingcode="{{settingtf.code}}" data-dayid="{{day.id}}"
									data-timeframe="{{timeframe.code}}"
									ng-repeat="settingtf in timeframe.settings"> <span
									class="{{settingtf|settingBadgeStyle:currentUser}}">{{settingtf.code}}</span>
								</a>
								<div class="dropdown plusBox">
									<a id="plusButton-{{day.id}}-{{timeframe.code}}"
										href="#" class="tfExtra"
										data-toggle="dropdown" data-day="{{day.id}}"
										data-timeframe="{{timeframe.code}}" ng-click="selectTimeframe(timeframe)"> <span
										class="badge plusButton">MJ</span>
									</a>
									
									<ul class="dropdown-menu" role="menu"
										aria-labelledby="plusButton-{{day.id}}-{{timeframe.code}}">
										<li class="plusHeader">Je propose une partie de...</li>
										<li ng-repeat="setting in settingsList"><a tabindex="-1"
											href="#">{{setting.name}}</a></li>
									</ul>
								</div>

							</div>
						</div>
					</div>
				</div>

			</div>
		</div>


		<!--
	<div class="mainColumn">


		<script>
		 $(function() {
		// run the currently selected effect
			$( "#dispoModal" ).on('show.bs.modal', function () {
				$( "#dispoCarousel" ).carousel(0);
			});
			$( ".massDispoStatusButton" ).click(function() {
				$( "#dispoCarousel" ).carousel(1);				
				return false;
			});
			$( ".massDispoSettingButton" ).click(function() {
				$(this).addClass("btn-primary");
				$( "#dispoCarousel" ).carousel(2);
				
				return false;
			});
		});
		</script>
	
	<div id="dispoModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="dispoModalLabel" aria-hidden="true">
	  <div class="modal-dialog">
	    <div class="modal-content">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
			<h3 id="dispoModalLabel">Je suis dispo pour...</h3>
		</div>
		<div class="modal-body">
		    <div id="dispoCarousel" class="carousel slide" data-interval="false">

			    <div class="carousel-inner">
				<div class="active item btn-group-vertical">
				  <button type="button" class="btn btn-primary massDispoStatusButton">... jouer à...</button>
				  <button type="button" class="btn btn-primary massDispoStatusButton">... maîtriser à...</button>
				</div>
				<div class="item btn-group-vertical">
				  <button type="button" class="btn btn-primary massDispoSettingButton"><span class="badge">EP</span> Eclipse Phase</button>
				  <button type="button" class="btn btn-primary massDispoSettingButton"><span class="badge">7SP</span> 7th Sea: Pirates</button>
				  <button type="button" class="btn btn-primary massDispoSettingButton"><span class="badge">SRQ</span> Shadowrun: Québec</button>
				</div>
				<div class="item" id="dispoSlide3">DIV 3</div>
			    </div>
		    </div>		
		</div>
		<div class="modal-footer">
			<button type="button" class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
			<button type="button" class="btn btn-primary">Save changes</button>
		</div>
	     </div>
	  </div>
	</div>

	<a data-toggle="modal" href="#dispoModal" class="btn btn-primary btn-lg">Donner mes disponibilités</a>
	<div class="panel panel-primary">
		<div class="panel-heading">Je suis dispo pour...</div>
		<div class="panel-body containerPanel">
		      <div class="row availFormRow">
			<div class="col-lg-9">
				<button type="button" class="btn btn-default">Jouer à:</button>
				<span class="badge">EP</span> <span class="badge">7TH</span>
			</div>
			<div class="col-lg-3">
				<button type="button" class="btn btn-default">Modifier</button>
			</div>
		       </div>
		      <div class="row availFormRow">
			<div class="col-lg-9">
				<button type="button" class="btn btn-default">Maîtriser à:</button>
				<span class="badge">EP</span>
			</div>
			<div class="col-lg-3">
				<button type="button" class="btn btn-default">Modifier</button>
			</div>
		      </div>
		</div>
	</div>
	
		<div class="panel panel-primary">
			<div class="panel-heading">Filtres</div>
			<div class="panel-body containerPanel">
				<form class="form-horizontal" role="form">
				<div class="innerHeading">Raccourcis</div>
				<div class="btn-group">
					<button type="button" class="btn btn-default">Mes dispos</button>
					<button type="button" class="btn btn-default">Toutes les parties</button>
					<button type="button" class="btn btn-default">Mes dispos</button>
					<button type="button" class="btn btn-default">Les MJ dispos</button>
				</div>
				<div class="innerHeading">Paramètres détaillés</div>
				<div class="form-group filterFormRow">
					<label class="col-lg-3 control-label" for="inputFilterGameStatus">Parties</label>
					<div class="col-lg-9">
						<select class="form-control" id="inputFilterGameStatus">
						  <option>Toutes</option>
						  <option>Validées</option>
						  <option>Potentielles - MJ Dispo</option>
						  <option>Potentielles - Pas de MJ</option>
						</select>
					</div>
				</div>
				<div class="form-group filterFormRow">
					<label class="col-lg-3 control-label" for="inputFilterSetting">Chronique</label>
					<div class="col-lg-9">
						<select class="form-control" id="inputFilterSetting">
						  <option>Toutes</option>
						  <option>Chronique 1</option>
						  <option>Chronique 2</option>
						  <option>Chronique 3</option>
						</select>
					</div>
				</div>
				<div class="filterFormRow">
					<label class="col-lg-3 control-label">Joueur</label>
					<div class="col-lg-9">
						<label class="checkbox-inline">
						  <input type="checkbox" id="inlineCheckbox1" value="option1"> Tous les joueurs
						</label>
						<label class="checkbox-inline">
						  <input type="checkbox" id="inlineCheckbox2" value="option2"> Seulement Moi
						</label>
					</div>
				</div>
				</form>
			</div>
		</div>
	</div>


		<div class="gg-container">
			<ul>
				<li ng-repeat="week in weeks">
					<p ng-repeat="day in week.days">{{day.dow}}</p>
				</li>
			</ul>
		</div>
	</div>
	-->
</body>
</html>

