<!DOCTYPE html>
<html lang="en" ng-app="gamegrinderApp">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="utf-8">
<title>Tests Gamegrinder</title>

<link rel="stylesheet" href="css/jquery.qtip.css">
<link rel="stylesheet" href="css/gg.css">

<script src="js/jquery-1.9.1.js"></script>
<script type="text/javascript" src="js/jquery.qtip.js"></script>

<script src="lib/angular/angular.js"></script>
<script src="lib/angular/angular-cookies.js"></script>
<script src="js/gg.js"></script>
<script src="js/app.js"></script>
<script src="js/controllers.js"></script>
<script src="js/directives.js"></script>
<script src="js/filters.js"></script>
<script src="js/services.js"></script>

</head>
<body ng-controller="GameGrinderCtrl">
	<script type="text/javascript">

		$(function() {
			$('#logindialogcontainer').qtip({
			    style: {
				    classes: 'ggpanel logindialog'
			    },
			    content: {
				    text: $('#logindialog')
			    },
			    position: {
        	            my: 'center',
				    at: 'center',
				    target: $(window)
			    },
			    show: {
		                    autofocus: '#inputName',
	        	            event: false,
				    modal: {
	        	                on: true,
				        blur: false,
				        escape: false
				    }
			    },
			    hide: false
			});
			$('[ttip!=""]').qtip({
				style: { classes: 'infoTooltip' },
				content: { attr: 'ttip' },
				position: {
					my: 'bottom left',
					at: 'top right'
				},
				show: {
					event: 'mouseenter click',
				},
				hide: {
					delay: 10,
					event: 'mouseleave',
				}
			});
			$('.tfExtra').each(function() {
				$(this).qtip({
				    style: {
					classes: 'ggpanel'
				    },
				    content: {
					text: $(this).next('div')
				    },
				    position: {
					my: 'top center',
					at: 'bottom center'
				    },
				    show: {
					event: 'mouseenter click',
					solo: '.tfExtra'
				    },
				    hide: {
					delay: 100,
					fixed: 'true',
					event: 'mouseleave',
				    },
				    events: {
					hide: function(event, api) {
						$(this).find('.collapsed').hide();
						$(this).find('.collapsible').show();
					}
				    }
				});
			});
			if (typeof angular.element('body').scope().currentUser == 'undefined') {
				$( "#logindialogcontainer" ).qtip( "toggle", true );
			}
			$('#loginForm').submit(function(event) {
				$( "#logindialogcontainer" ).qtip( "toggle", false );
			});
			$('.dayPanel').hover(function(event) {
				$(this).find(".datePanel").addClass("hoverDay");
			},
			function(event) {
				$(this).find(".datePanel").removeClass("hoverDay");
			});
			$('.settingTrigger').click(function(event) {
				$(this).slideUp(200);
				var $box=$(this).next('.settingEditor');
				$box.slideDown(200);
				$box.find('.inputSetting').focus();
			});
			$('.settingButton').click(function(event) {
				var $box = $(this).parents('.settingEditor');
				$box.slideUp(200);
				$box.prev('.settingTrigger').slideDown(200);
			});
		});
	</script>
   <div id="logindialogcontainer" style="display: none">
	<div id="logindialog">
		<form class="form-inline" id="loginForm" role="form"
			name="loginForm" ng-submit="login()">
			<div class="ggpanelHeader ggpanelItem glossyHeader hoverDay">C'est qui ?</div>
			<div class="ggpanelItem">
				<button id="nameButton" class="rightbutton" ng-disabled="loginForm.$invalid" type="submit">Valider</button>				<label for="inputName">Tape ton
					pseudo:</label> <input type="text" id="inputName"
					name="userinput" placeholder="Ton pseudo sur le forum"
					ng-model="currentUser" required />
			</div>
		</form>
	</div>
    </div>

	<div id="toolbar" class="pageColumn">
		<div id="greetingsDiv" class="ggpanel" ng-show="currentUser">
			<div class="ggpanelItem ggpanelHeader glossyHeader">Salut {{ currentUser }} !</div>
			<div class="ggpanelItem ggbuttonbox">
				<button type="button" ng-click="logout()">Changer d'utilisateur</button>
			</div>
		</div>

		<div id="legendContainer" class="ggpanel">
			<div class="ggpanelItem ggpanelHeader glossyHeader" ttip="Cliquez sur une ligne pour cacher/afficher les cases correspondantes">Légende</div>
				<div class="ggpanelItem ggclickablelistitem" ng-class="{ggDisabledItem : isInArray(status.id, invisibleStatus)}" ng-click="toggleStatusVisibility(status.id)" ng-repeat="status in tfSettingStatus">
					<div class="legendBadge settingCell ggpanelCell"><span class="badge {{status.style}}">--</span></div>
					<div class="settingCell ggpanelCell legendCell"><span>{{status.desc}}</span></div>
				</div>
		</div>

		<div id="campaignsContainer" class="dummyContainer">
            <div class="ggpanel">
                <div class="ggpanelItem ggpanelHeader glossyHeader" ttip="Cliquez sur une chronique pour la rendre visible/invisible dans votre planning">One-Shots</div>
                
                <div class="ggpanelItem ggclickablelistitem" ng-repeat="setting in settingsList | filter: { mode: 2, status: 0} | orderBy: 'name'" ng-click="toggleSettingVisibility(setting.id, true)">
                    <div class="legendBadge settingCell ggpanelCell"><span class="badge">{{setting.code }}</span></div>
                    <div class="settingCell ggpanelCell legendCell"><span>{{ setting.name }}</span></div>
                </div>
            </div>
            
            <div class="ggpanel">
                <div class="ggpanelItem ggpanelHeader glossyHeader" ttip="Cliquez sur une chronique pour la rendre visible/invisible dans votre planning">Chroniques Ouvertes</div>
                
                <div class="ggpanelItem ggclickablelistitem" ng-repeat="setting in settingsList | filter: { mode: 0, status: 0} | orderBy: 'name'" ng-click="toggleSettingVisibility(setting.id, true)"  ng-class="{ggDisabledItem : isInArray(setting.id, invisibleOpenSettings)}">
                    <div class="legendBadge settingCell ggpanelCell"><span class="badge">{{setting.code }}</span></div>
                    <div class="settingCell ggpanelCell legendCell"><span>{{ setting.name }}</span></div>
                </div>
            </div>
            
            <div class="ggpanel">
                <div class="ggpanelItem ggpanelHeader glossyHeader" ttip="Cliquez sur une chronique pour la rendre visible/invisible dans votre planning">Chroniques Fermées</div>
                
                <div class="ggpanelItem ggclickablelistitem" ng-repeat="setting in settingsList | filter: { mode: 1, status: 0} | orderBy: 'name'" ng-click="toggleSettingVisibility(setting.id, false)"  ng-class="{ggDisabledItem : isInArray(setting.id, visibleClosedSettings)}">
                    <div class="legendBadge settingCell ggpanelCell"><span class="badge">{{setting.code }}</span></div>
                    <div class="settingCell ggpanelCell legendCell"><span>{{ setting.name }}</span></div>
                </div>
            </div>
            
		</div>
	</div>

	<div class="pageColumn" ng-if="settingsReady">
		<div class="weekPanel" ng-repeat="week in weeks">

			<div class="day{{day.dow}} dayPanel" ng-repeat="day in week.days">
						<div class="datePanel glossyHeader">

								<span>{{ dowcodes[day.dow] }}</span> <br /><span>{{ day.dom }} / {{ day.month }}</span>
						</div>
						<div class="timeFramePanel"
							ng-repeat="timeframe in day.timeframes">
								<img class="timeFrameItem" ttip="{{timeframesDesc[timeframe.code].name}}" 	src="{{timeframesDesc[timeframe.code].pic}}"/>
								<a href="#" class="tfSetting" ng-repeat="settingtf in timeframe.settings" ng-init="status=getTfSettingStatus(day.id, timeframe.code, settingtf.code)" ng-show="isTfSettingVisible(settingtf.code, status)">
									<span class="badge {{tfSettingStatus[status.code()].style}}">{{settingtf.code}}</span>
									<gg-tf-setting-tooltip dayid="day.id" timeframe="timeframesDesc[timeframe.code]" setting="settingsHash[settingtf.code]" status="status" user="currentUser" schedule="settingtf" comment="comment"></gg-tf-setting-tooltip>
								</a>

								<div class="timeFrameItem dropdown plusBox">
									<img id="plusButton-{{day.id}}-{{timeframe.code}}" class="tfExtra timeFrameItem plusButton" src="images/plus.gif"	data-day="{{day.id}}" data-timeframe="{{timeframe.code}}" ng-click="selectTimeframe(timeframe)">
									<div class="ggdropdown addSettingDropdown">
										<div class="ggpanelItem ggpanelHeader glossyHeader hoverDay">Je propose une partie de...</div>
<div class="ggpanelItem ggclickablelistitem dropdownItem settingTrigger hoverDay collapsible">Créer une Chronique / One-Shot</div>
										<div class="ggpanelItem dropdownItem settingEditor collapsed dummyContainer" >
<form class="form-inline" role="form" name="createSettingForm" ng-submit="createSetting()" novalidate>
	<div class="ggpanelSubheader hoverDay">
	    Nouvelle Chronique / One-Shot
	</div>
	<div class="ggpanelSubitem"><input type="text" class="inputSettingName expand" name="settingName" placeholder="Nom de la chronique" ng-model="newsetting.name" required maxlength="32"/></span>
	</div>
	<div class="ggpanelSubitem centered">
        <span class="badge" ng-click="newsetting.mode=0" ng-class="{ noPlayBadge : newsetting.mode == 0 }">Ouverte</span>
        <span class="badge" ng-click="newsetting.mode=1" ng-class="{ noPlayBadge : newsetting.mode == 1 }">Fermée</span>
        <span class="badge" ng-click="newsetting.mode=2" ng-class="{ noPlayBadge : newsetting.mode == 2 }">One-Shot</span>
	</div>
	<div class="ggpanelSubitem">
	    Code (3 lettres max) <input type="text" class="inputSettingCode" name="settingCode" placeholder="XXX" ng-model="newsetting.code" required size="3" maxlength="3"/>
		<button class="settingButton rightbutton" ng-disabled="createSettingForm.$invalid || (newsetting.mode<0)" type="submit">Valider</button>
	</div>
 </form>
										</div>
										<div class="ggpanelItem ggclickablelistitem dropdownItem" ng-repeat="setting in settingsList | filter: {status: 0} | orderBy: 'name'">{{setting.name}}</div>
									</div>
								</div>

						</div>
			</div>

			</div>
		</div>
	

</body>
</html>

